<!DOCTYPE html><html lang="zh_CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Hi~,靓仔 - 每天坚持写bug</title><meta name="author" content="黄大官AOSP"><meta name="copyright" content="黄大官AOSP"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="Hi~,靓仔">
<meta property="og:url" content="https://me.debuglive.cn/index.html">
<meta property="og:site_name" content="Hi~,靓仔">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://me.debuglive.cn/img/avatar.jpeg">
<meta property="article:author" content="黄大官AOSP">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://me.debuglive.cn/img/avatar.jpeg"><link rel="shortcut icon" href="/img/avatar.jpeg"><link rel="canonical" href="https://me.debuglive.cn/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Hi~,靓仔',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-11-17 14:47:31'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Hi~,靓仔"><span class="site-name">Hi~,靓仔</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Hi~,靓仔</h1></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/11/13/Android%20Studio%E9%85%8D%E7%BD%AEollvm%E7%BC%96%E8%AF%91so/" title="Android Studio配置ollvm编译so">Android Studio配置ollvm编译so</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2023-11-13T02:52:19.000Z" title="Created 2023-11-13 10:52:19">2023-11-13</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android/">Android</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Android/">Android</a></span></div><div class="content">背景在项目中有使用jni实现功能，编译最终包是时候ollvm混淆so中逻辑。在macOS中编译出混淆的so。

环境：
1234macOS 12.6 Intel x86_64ndkVersion &quot;21.4.7075529&quot;cmake version 3.18.0Android Studio Chipmunk | 2021.2.1 Patch 2

编译ollvm默认ndk中clang-ollvm是没有带混淆的，需要我们自己编译一次。
仓库地址：https://github.com/heroims/obfuscator

选择分支llvm-9.0.1
完整命令：
1https://github.com/heroims/obfuscator.git -b llvm-9.0.1

找一个目录下载，大概500m这样。
12~/android/hook/llvmobfuscator

在llvm目录中创建一个build目录
12345678~/android/hook/llvmmkdir buildcd build# 执行初始化配置cmake -DCMAKE_BUILD_T ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/11/06/AOSP%20Android%2010%E5%86%85%E7%BD%AEFridaGadget%E5%AE%9E%E8%B7%B502/" title="AOSP Android 10内置FridaGadget实践02">AOSP Android 10内置FridaGadget实践02</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2023-11-06T02:55:19.000Z" title="Created 2023-11-06 10:55:19">2023-11-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android-AOSP%E5%AD%A6%E4%B9%A0/">Android AOSP学习</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/AOSP/">AOSP</a></span></div><div class="content">背景内置frida-gadget前篇：AOSP Android 10内置FridaGadget实践01
上一篇内置完成脚本管理app后复制脚本到/data/system/xsettings目录下无权限。

现在开始给文件夹配置权限。
环境：
vm Ubuntu 18.04
AOSP 10_r41
Pixel 3
as
文件夹权限配置位置和文件：
0x1:android-10.0.0_r41&#x2F;system&#x2F;sepolicy&#x2F;public&#x2F;file.te
末尾增加一行这里和文件夹有关是xxxxx_file。这个目录名字就是当时在rc文件配置的xsettings&#x2F;xxxxx目录
1type xiaojianbang_file, file_type, data_file_type, core_data_file_type, mlstrustedobject;

0x1:android-10.0.0_r41&#x2F;system&#x2F;sepolicy&#x2F;private&#x2F;file_contextandroid-10.0.0 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/11/06/AOSP%20Android%2010%E5%86%85%E7%BD%AEFridaGadget%E5%AE%9E%E8%B7%B501/" title="AOSP Android 10内置FridaGadget实践01">AOSP Android 10内置FridaGadget实践01</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2023-11-06T02:53:19.000Z" title="Created 2023-11-06 10:53:19">2023-11-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android-AOSP%E5%AD%A6%E4%B9%A0/">Android AOSP学习</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/AOSP/">AOSP</a></span></div><div class="content">背景想做frida持久化hook，通过搜索资料发现gadget可以。


这是官方的资料：https://frida.re/docs/gadget/
这里有详细的使用方法，比如反编译apk插入so文件，如果这个app没有so库，就需要自己在application自己加代码load so，但是这些都不是我现在需要的操作。
我既然修改的是AOSP，在app加载的时候加载so就行了。
经过搜索资料发现了这个博客：http://zhuoyue360.com/crack/78.html
这里面应该学习了某个大佬的课程然后分享出来的，经过分析和实践验证了博客中的一部分内容是可行的，有一些重要的部分是没有的，但是主干思路有了之后剩下的部分有盼头了。
实践与验证环境：
AOSP 10 r41
pixel 3
Ubuntu 18.04

修改app的启动流程，在启动期间去加载so。在frameworks/base/core/java/android/app/ActivityThread.java中的handleBindApplication
方法中，找到Application创建之前的位置，经过我的测试 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/11/06/AOSP%20Android%2010%E5%86%85%E6%A0%B8%E7%BC%96%E8%AF%91%E5%88%B7%E5%85%A5Pixel3/" title="AOSP Android 10内核编译刷入Pixel3">AOSP Android 10内核编译刷入Pixel3</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2023-11-06T02:52:19.000Z" title="Created 2023-11-06 10:52:19">2023-11-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android-AOSP%E5%AD%A6%E4%B9%A0/">Android AOSP学习</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/AOSP/">AOSP</a></span></div><div class="content">背景下载Android10的内核源码编译并刷入Pixel3中，为后面的过反调试做准备。

环境mv Ubuntu 18.04
已经成功编译的AOSP 10_r41环境，编译内核需要源码交叉编译环境。
Pixel3
下载内核代码Ubuntu中找个非中文路径的位置
123456mkdir ~/binecho &quot;PATH=~/bin:\$PATH&quot; &gt;&gt; ~/.bashrcsource ~/.bashrccurl https://storage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo## 或者使用 curl https://mirrors.tuna.tsinghua.edu.cn/git/git-repo -o repochmod a+x ~/bin/repo

repo是用来下载代码的，如果你已经安装了就进入下一步。
12345678910## 创建一个目录mkdir k## 例如我的目录是/home/aosp/kcd krepo init -u https://android.googl ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/11/06/AOSP%20Android%2010%E5%AF%BC%E5%85%A5BurpSuite%20CA%E8%AF%81%E4%B9%A6%E6%8A%93%E5%8C%85/" title="AOSP Android 10导入BurpSuite CA证书抓包">AOSP Android 10导入BurpSuite CA证书抓包</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2023-11-06T01:55:19.000Z" title="Created 2023-11-06 09:55:19">2023-11-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android-AOSP%E5%AD%A6%E4%B9%A0/">Android AOSP学习</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/AOSP/">AOSP</a></span></div><div class="content">证书准备从burp中导出证书，一般是der文件。
使用openssl将der格式转为pem格式，再转.0文件导入系统。

1234# 转为pem格式openssl x509 -inform DER -in cacert.der -out cacert.pem# 重命名为&lt;hash值&gt;.0mv cacert.pem `openssl x509 -inform PEM -subject_hash_old -in cacert.pem |head -1`&#x27;.0&#x27;


查看哈希可以这样。
12//哈希openssl x509 -subject_hash_old -in &lt;certificate.pem&gt;

导入Android10系统证书存放目录
12// 证书位置，我们要放证书到这里/system/etc/security/cacerts






重启手机查看结果。
查看是否导入手机重启完成之后打开设置。AOSP Android10.0设置：安全：加密与凭证：信任的凭证


可以看到用户证书这里是没有的。

PortSwigger就是我们导入的了 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/11/06/AOSP%20Android%2010.0%E6%97%A0%E6%BA%90%E7%A0%81%E5%86%85%E7%BD%AEapk%E5%88%B0%E7%B3%BB%E7%BB%9F/" title="AOSP Android 10.0无源码内置apk到系统">AOSP Android 10.0无源码内置apk到系统</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2023-11-06T01:53:19.000Z" title="Created 2023-11-06 09:53:19">2023-11-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android-AOSP%E5%AD%A6%E4%B9%A0/">Android AOSP学习</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/AOSP/">AOSP</a></span></div><div class="content">背景环境 AOSP 10
当我们经常编译AOSP后有可能需要全量更新我们的修改，全量更新就意味着之前我们手机上面安装的软件都清空了，等同于回复出厂设置，那么我们可不可以提前放入一些我们自己需要用的APP呢，刷机之后APP就不用重复安装了。

无源码内置apk到系统这一次我们先做一个无源码无so库的APP到系统中。
有so库的下一篇实践。
准备工作准备好apk安装包，这个包也可以是自己的，也有可能是客户给的，只给成品不给源码。这是前提。
比如我现在就编写了一个简单的无so的apk。


App名字就是内置App。编译成功之后先安装到手机看看运行情况，是否会崩溃等等检查。

能看到我们的log正常输入，且App没有崩溃。我们把这个apk复制到这里：在源码目录下packages&#x2F;apps下创建一个目录，这个目录就是我们存放apk的目录。创建MyApp目录，保存上面打包出来的apk文件，命名MyApp.apk。


创建Android.mk文件，文件内容是这样的。
123456789LOCAL_PATH:= $(call my-dir)include $(CLEAR_VARS)LOC ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/11/06/AOSP%20Android%2010.0%E5%8D%95%E7%BC%96%E6%9B%BF%E6%8D%A2framework.jar%E5%88%B7%E5%85%A5%E6%89%8B%E6%9C%BA/" title="AOSP Android 10.0单编替换framework.jar刷入手机">AOSP Android 10.0单编替换framework.jar刷入手机</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2023-11-06T01:52:19.000Z" title="Created 2023-11-06 09:52:19">2023-11-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android-AOSP%E5%AD%A6%E4%B9%A0/">Android AOSP学习</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/AOSP/">AOSP</a></span></div><div class="content">背景修改framework的部分代码，做一些特殊的事。基于AOSP 10.0
公众号地址：https://mp.weixin.qq.com/s/eNbePpJ-LU7D_Gt7YVKjrw


编译framework代码当我们修改完成framework模块的代码之后，需要编译模块，我之前不知道可以直接单独编译和刷入手机的，导致浪费了很多时间。
修改完成代码保存之后，进入framework&#x2F;base目录执行mm
前提是注入了aosp的环境变量。
1234source build/envsetup.shlunch xxcd framework/basemm

编译完成之后。

刷入手机验证编译完成之后的产物目录
android-10.0.0_r41\out\target\product\blueline\system\framework\framework.jar
目录下有一个framework.jar(这个jar就是框架的代码)里面都是dex，如果想看代码，可以去这个目录下看，就好像平时看第三方jar一样，导入as即可。
android-10.0.0_r41\out\soong ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/11/06/Ubuntu%2018.04%E7%BC%96%E8%AF%91AOSP%2010.0r41%E5%88%B7%E5%85%A5pixel3/" title="Ubuntu 18.04编译AOSP 10.0r41刷入pixel3">Ubuntu 18.04编译AOSP 10.0r41刷入pixel3</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2023-11-06T01:49:19.000Z" title="Created 2023-11-06 09:49:19">2023-11-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android-AOSP%E5%AD%A6%E4%B9%A0/">Android AOSP学习</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/AOSP/">AOSP</a></span></div><div class="content">背景已经在AOSP 7.1.1 nexus 5x上面实现了修改位置打卡，现在是想在pixel3中继续尝试。

如何选择代码要选择有对应驱动版本的代码分支，如果没有标明，强行用其他版本的驱动来编译刷机不知道是否可行。
比如我选择的情况是这样的。
https://developers.google.com/android/drivers#bluelinepd1a.180720.030
https://source.android.com/docs/setup/about/build-numbers?hl=zh-cn
这里是查代码分支和驱动版本的网站。

为什么呢？因为我的网盘中的Android10代码有这个分支，如果通过repo的方式下载，我网络太差了，容易失败，相信很多人放弃都会卡在这一步，下个代码都下不了。
我们之间下载某个分支的代码就行了，前提是这个分支刚好有驱动。
复制代号：QQ3A.200805.001
去驱动的网页上面搜索：

在这里找到你的手机和对应代号的驱动。
android-10.0.0_r41 -&gt; QQ3A.200805.001 &gt; Pixel 3 bin ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/11/06/Ubuntu%2018.04%E7%BC%96%E8%AF%91AOSP%207.1.1/" title="Ubuntu 18.04编译AOSP 7.1.1">Ubuntu 18.04编译AOSP 7.1.1</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2023-11-06T01:44:19.000Z" title="Created 2023-11-06 09:44:19">2023-11-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android-AOSP%E5%AD%A6%E4%B9%A0/">Android AOSP学习</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/AOSP/">AOSP</a></span></div><div class="content">背景前面一篇文章编译6.0本来是想给nexus5x刷的，结果Google没有提供驱动，那就给我的nexus5刷了。现在找到了5x需要的驱动和代码版本号，今天继续刷。

刷机和代码对应比如我需要给5x刷，就需要对应的驱动，驱动下载地址在这里。
https://developers.google.com/android/drivers#bullhead
需要具备留学资格访问。
在这个地方找到了自己设备的驱动之后，看版本号。然后到这里找对应的代码分支。
https://source.android.com/docs/setup/about/build-numbers?hl=zh-cn
找到分支后，后面会显示支持的手机的，下载代码的时候就可以下对应的分支了。
编译环境和上一篇文章一样，https://mp.weixin.qq.com/s?__biz=MzU1NjYyNjA3MQ==&amp;mid=2247484175&amp;idx=1&amp;sn=451bace9965a369a0f85f71fda61f509&amp;chksm=fbc37af7ccb4f3e1a0d9f0308834 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2023/11/06/Ubuntu%2018.04%E7%BC%96%E8%AF%91AOSP%206.0.1/" title="Ubuntu 18.04编译AOSP 6.0.1">Ubuntu 18.04编译AOSP 6.0.1</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2023-11-06T01:42:19.000Z" title="Created 2023-11-06 09:42:19">2023-11-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Android-AOSP%E5%AD%A6%E4%B9%A0/">Android AOSP学习</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/AOSP/">AOSP</a></span></div><div class="content">背景编译6.0.1版本自己刷机到nexus 5x中


代码下载这一步忽略，方法很多，我们直接开始编译遇到的问题。
遇到问题和解决方法编译6.0系统需要openjdk 7
编译5.1系统需要jdk7，如果需要编译5.1的后面再出文章吧。
编译前提删除源码目录下所有git
1234find ./ -name &quot;.git&quot; | xargs rm -rf//大小du -sh -BG


下载openjdk7

链接：https://pan.baidu.com/s/1u_GcyI-nrrQPLv_NQ2CwRg提取码：0jt0
信不过网盘的可以去这里下https://jdk.java.net/java-se-ri/7
1234567891011121314sudo tar zxvf openjdk-7u75-b13-linux-x64-18_dec_2014.tar.gz -C /opt# 修改profile文件sudo gedit /etc/profile# 加入下面的配置export JAVA_HOME=/opt/java-se-7u75-riexport JRE_HO ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">黄大官AOSP</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">11</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/13/Android%20Studio%E9%85%8D%E7%BD%AEollvm%E7%BC%96%E8%AF%91so/" title="Android Studio配置ollvm编译so">Android Studio配置ollvm编译so</a><time datetime="2023-11-13T02:52:19.000Z" title="Created 2023-11-13 10:52:19">2023-11-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/06/AOSP%20Android%2010%E5%86%85%E7%BD%AEFridaGadget%E5%AE%9E%E8%B7%B502/" title="AOSP Android 10内置FridaGadget实践02">AOSP Android 10内置FridaGadget实践02</a><time datetime="2023-11-06T02:55:19.000Z" title="Created 2023-11-06 10:55:19">2023-11-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/06/AOSP%20Android%2010%E5%86%85%E7%BD%AEFridaGadget%E5%AE%9E%E8%B7%B501/" title="AOSP Android 10内置FridaGadget实践01">AOSP Android 10内置FridaGadget实践01</a><time datetime="2023-11-06T02:53:19.000Z" title="Created 2023-11-06 10:53:19">2023-11-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/06/AOSP%20Android%2010%E5%86%85%E6%A0%B8%E7%BC%96%E8%AF%91%E5%88%B7%E5%85%A5Pixel3/" title="AOSP Android 10内核编译刷入Pixel3">AOSP Android 10内核编译刷入Pixel3</a><time datetime="2023-11-06T02:52:19.000Z" title="Created 2023-11-06 10:52:19">2023-11-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/11/06/AOSP%20Android%2010%E5%AF%BC%E5%85%A5BurpSuite%20CA%E8%AF%81%E4%B9%A6%E6%8A%93%E5%8C%85/" title="AOSP Android 10导入BurpSuite CA证书抓包">AOSP Android 10导入BurpSuite CA证书抓包</a><time datetime="2023-11-06T01:55:19.000Z" title="Created 2023-11-06 09:55:19">2023-11-06</time></div></div></div></div><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-comment-dots"></i><span>Latest Comments</span></div><div class="aside-list"><span>loading...</span></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>Categories</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Android/"><span class="card-category-list-name">Android</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Android-AOSP%E5%AD%A6%E4%B9%A0/"><span class="card-category-list-name">Android AOSP学习</span><span class="card-category-list-count">10</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>Tags</span></div><div class="card-tag-cloud"><a href="/tags/Android/" style="font-size: 1.1em; color: #999">Android</a> <a href="/tags/AOSP/" style="font-size: 1.5em; color: #99a9bf">AOSP</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>Archives</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">十一月 2023</span><span class="card-archive-list-count">11</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>Info</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">Article :</div><div class="item-count">11</div></div><div class="webinfo-item"><div class="item-name">Runtime :</div><div class="item-count" id="runtimeshow" data-publishDate="2023-11-10T16:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">UV :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">PV :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">Last Update :</div><div class="item-count" id="last-push-date" data-lastPushDate="2023-11-17T06:47:31.185Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 黄大官AOSP</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="Toggle Between Traditional Chinese And Simplified Chinese">簡</button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[image]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[link]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[code]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const findTrueUrl = (array) => {
    Promise.all(array.map(item =>
      fetch(item.url).then(resp => resp.json()).then(data => {
        const urlArray = data.body.match(/(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?/ig)
        if (data.user.login === 'utterances-bot') {
          return urlArray.pop()
        } else {
          return urlArray.shift()
        }
      })
    )).then(res => {
        array = array.map((i,index)=> {
          return {
            ...i,
            url: res[index]
          }
        })

        saveToLocal.set('github-newest-comments', JSON.stringify(array), 10/(60*24))
        generateHtml(array)
    });
  }

  const getComment = () => {
    fetch('https://api.github.com/repos/df13954/my_blog/issues/comments?sort=updated&direction=desc&per_page=6&page=1',{
      "headers": {
        Accept: 'application/vnd.github.v3.html+json'
      }
    })
      .then(response => response.json())
      .then(data => {
        const githubArray = data.map(item => {
          return {
            'avatar': item.user.avatar_url,
            'content': changeContent(item.body_html),
            'nick': item.user.login,
            'url': item.issue_url,
            'date': item.updated_at,
            'githubUrl': item.html_url
          }
        })
        findTrueUrl(githubArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "Unable to retrieve comments, please check the configuration"
      })
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += 'No comments'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('github-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><div class="fb-customerchat" id="fb-customer-chat" attribution="biz_inbox"></div><script>(() => {
  document.getElementById('fb-root') ? '' : document.body.insertAdjacentHTML('afterend', '<div id="fb-root"></div>')

  window.fbAsyncInit = function() {
    FB.init({
      xfbml: true,
      version: 'v16.0'
    });
  };

  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = 'https://connect.facebook.net/zh_CN/sdk/xfbml.customerchat.js';
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));

  const isChatBtn = false
  const isChatHideShow = false

  if (isChatBtn) {
    window.chatBtnFn = () => {
      const isShow = document.querySelector('.fb_customer_chat_bounce_in_v2')
      isShow ? FB.CustomerChat.hide() : FB.CustomerChat.show()
    }
  } else if (isChatHideShow) {
    window.chatBtn = {
      hide: () => {
        FB.CustomerChat.hide()
      },
      show: () => {
        FB.CustomerChat.show(false)
      }
    }
  }
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>